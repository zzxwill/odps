# 计量计费说明 {#concept_f32_fpm_xdb .concept}

**关于MaxCompute计量计费：**

-   计费单元：项目（Project）

-   计费模块：存储、计算、数据下载

-   计费周期：天


## 存储计费 {#section_efw_kpm_xdb .section}

存储到MaxCompute的数据，包括表（Table）和资源（Resource）等，会按照其数据容量的大小进行阶梯计费，计费周期为**天**。

MaxCompute以小时级别采集您的每个项目空间下当前的存储使用情况，并以项目空间为基本单位，计算当天的存储平均值再乘以单价。

|1GB以内（包括）USD/GB/Day|1GB到100GB之间USD/GB/Day|100GB到1TB之间USD/GB/Day|1TB到10TB之间USD/GB/Day|10TB到100TB之间USD/GB/Day|100TB到1PB之间USD/GB/Day|1PB以上部分USD/GB/Day|
|:------------------|:--------------------|:--------------------|:-------------------|:---------------------|:--------------------|-----------------|
|Free|0.0028|0.0014|0.0013|0.0011|0.0009|请通过工单联系我们|

例如您的某个项目的存储为50TB，则每天收取的费用如下：

```
（100GB-1）* 0.0028 USD/GB/day
+（1024-100）GB* 0.0014 USD/GB/day
+（10240-1024）GB* 0.0013 USD/GB/day
+（50*1024-10240）GB * 0.0011 USD/GB/day
=58.61 USD/day
```

**说明：** 

-   由于MaxCompute会对您的数据进行压缩存储，计费依据的容量大小是压缩后的数据，因此多数情况下与上传数据之前您自己统计的数据文件大小不同，压缩比一般在5倍左右。

-   账单出账时间通常在当前计费周期结束后三小时内，最长不超过六个小时。例如前一天的账单一般会在第二天06:00以前生成，具体以系统出账时间为准，账单生成后会自动从您绑定的信用卡中扣除费用以结算账单。

-   若您对账单存在疑虑，可以进入**费用中心**查看消费明细。


## 计算计费 {#section_lfw_kpm_xdb .section}

MaxCompute有以下两种计算计费方式。

-   按量后付费方式。即以作业的消耗作为计量指标，在作业执行后收取费用。

-   按CU预付费方式。即您提前预定一部分资源，按CU预付费方式仅在**阿里云大数据平台**上提供。


目前MaxCompute开放的计算任务类型有SQL、UDF、MapReduce、Graph及机器学习作业。其中SQL（不包括UDF）计算任务已经收费，MapReduce任务在2017年12月19日启动收费，其他类型暂无收费计划。

**按量后付费**

按量后付费方式是针对SQL任务和MapReduce任务进行计费。

SQL任务按量后付费

即SQL按I/O后付费：您每执行一条SQL作业，MaxCompute将根据该作业的**输入数据量**及该SQL的**复杂度**进行计费。该费用在SQL执行完成后产生，并在第二天做一次性的计费结算。

MaxCompute SQL任务的按I/O后付费会针对每个作业产生一次计量。当天的所有计量信息将在第二天做一次性汇总收费。

SQL计算任务的计费公式如下所示：

```
一次SQL计算费用 = 计算输入数据量 * SQL复杂度 * SQL价格
```

价格如下：

|计费项|价格|
|:--|:-|
|SQL价格|0.0438 USD/GB|

-   **计算输入数据量**：指一条SQL语句实际扫描的数据量，大部分的SQL语句有分区过滤和列裁剪，所以一般情况下这个值会远小于源表数据的大小。

    -   列裁剪：例如您提交的SQL是`select f1,f2,f3 from t1;` 只计算t1表中f1，f2，f3三列的数据量，其他列不会参与计费。

    -   分区过滤：例如SQL语句中含有where ds\>”20130101”，ds是分区列，则计费的数据量只会包括实际读取的分区，不会包括其他分区的数据。

-   **SQL复杂度**：先统计SQL语句中的关键字，再折算为SQL复杂度，详情如下：

    -   SQL关键字个数 = Join个数 + Group By个数 + Order By个数 + Distinct个数 + 窗口函数个数 + max\(insert into个数-1, 1\)。

    -   SQL复杂度计算：

        -   SQL关键字个数小于等于3，复杂度为1。

        -   SQL关键字个数小于等于6，且大于等于4，复杂度为1.5。

        -   SQL关键字个数小于等于19，且大于等于7，复杂度为2。

        -   SQL关键字个数大于等于20，复杂度为4。


复杂度计量命令格式如下所示：

```
cost sql <SQL Sentence>;
```

示例如下：

```

odps@ $odps_project >cost sql SELECT DISTINCT total1 FROM
(SELECT id1, COUNT(f1) AS total1 FROM in1 GROUP BY id1) tmp1
ORDER BY total1 DESC LIMIT 100;

Complexity:1.5
```

示例中SQL关键字个数是4（该语句中有一个DISTINCT，一个COUNT，一个GROUP BY，一个ORDER），而SQL复杂度是1.5。如果表in1数据量为1.7GB，则实际消费如下：

```
1.7 * 1.5 * 0.0438 = 0.11 USD
```

**说明：** 

-   账单出账时间在第二天06:00前。在计算任务成功结束后，系统会统计该计算任务读取的数据量和SQL复杂度，账单生成后会自动从您绑定的信用卡中扣除费用以结算账单。没有成功的计算任务不扣费。

-   与存储类似，SQL计算也以压缩后的数据大小计费。


MapReduce按量后付费

2017年12月19日MaxCompute开始对MapReduce任务进行计费。MaxCompute MapReduce采用的计费标准如下所示：

```
MR 任务当日计算费用=当日总计算时＊ 单价（USD）
```

价格如下：

|计费项|价格|
|:--|:-|
|MR价格|0.0690 USD/Hour/Task|

一个MR任务一次执行成功的计算时 = 任务运行时间（小时）\* 任务调用的core数量。

如果一个MR任务一次执行成功是调用了100core并花费0.5小时，那么本次执行计算时为：0.5小时 \* 100core = 50个计算时。

MR计算任务成功结束后，系统会统计该计算任务所消耗的计算时，当天所有计量信息将在第二天做一次性汇总收费，生成账单，直接体现在账号账单中，并自动从您绑定的信用卡中扣除费用以结算账单。

**说明：** 

-   没有执行成功的计算任务不扣费。

-   任务排队时间不计入计量计时。

-   如果您购买了MaxCompute包年包月服务，则在您购买的服务范围内您可以免费使用MR计算任务，不会额外支付费用。


**按CU预付费**

此种方式仅在**阿里云大数据平台**上提供。您可以预先购买一部分资源，MaxCompute会预留您所购买的资源。此种资源的基本单位定义为CU（Compute Unit）。1CU包含的计算资源为4GB内存加上1核CPU：

|资源定义|内存|CPU|售价USD/month|
|:---|:-|:--|:----------|
|1 CU|4GB|1 CPU|22.0|

建议新用户先采用按I/O后付费方式进行结算。用户初期使用 MaxCompute 时，消耗的资源较少，采购CU预留资源会出现资源闲置。相对而言，按I/O后付费方式成本会更低。

## 下载计费 {#section_fgw_kpm_xdb .section}

对于公网或者跨Region的数据下载，MaxCompute将按照下载的数据大小进行计费。计费公式如下所示：

```
一次下载费用 = 下载数据量 * 下载价格
```

具体价格如下所示：

|计费项|价格USD/GB|
|:--|:-------|
|外网下载价格|0.1166|

**说明：** 

-   MaxCompute会按次推送您的下载计量信息，并在第二天给出您的下载费用消耗。

-   下载数据量：指一次下载请求的HTTP body的大小。承载数据的HTTP body使用protobuffer编码，因此一般比数据原始容量要小，但是比压缩后存储在MaxCompute上的数据量要大。

-   您通过不同的网络环境，例如公网、阿里云经典网络、VPC网络，或在不同的Region下，访问MaxCompute将有不同的计费行为。有关MaxCompute服务连接的详细介绍请参见[访问域名和数据中心](https://www.alibabacloud.com/help/zh/doc-detail/34951.htm)。


